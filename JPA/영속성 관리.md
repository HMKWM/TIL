# 영속성 관리

## 영속성 컨텍스트

### 영속성 컨텍스트란?

- JPA를 이해하는데 가장 중요한 단어
- "엔티티를 영구 저장하는 환경"이라는 뜻
- 눈에 보이지 않은 논리적인 개념이다.

영속성 매니저 팩토리가 영속성 매니저를 생성한다.

영속성 매니저를 통해 영속성 컨텍스트에 접근한다.


    EntityManagerFactory emf = Persistence.createEntityManagerFactory("hello");
    EntityManager em = emf.createEntityManager();
    EntityTransaction tx = em.getTransaction();
    try{
        ... 
        tx.commit();
    } ...
 
영속성 매니저 팩토리를 사용하기 위해, 다음과 같은 속성(값)이 필요하다.

- 데이터베이스 드라이버
- 데이터베이스 url,user, password값
- 데이터베이스 방언(Dialect)

### 데이터베이스 방언이란?

데이터베이스는 ANSI SQL를 표준으로 두고있다.

하지만 각자의 독자적인 기능을 가지며, 이를 방언이라한다.

RDB에 맞는 쿼리문을 사용하기위해 JPA는 방언기능을 제공한다.

그리고 하이버네이트에서 다양한 데이터베이스의 방언 구현체를 제공해준다.

## 주의

엔티티 매니저 팩토리는 하나만 생성해서 애플리케이션 전체에서 공유한다.

엔티티 매니저는 쓰레드간의 공유를 하지않는다. (사용하고 버려야한다)

JPA의 모든 데이터 변경은 트랜젝션 안에서 실행된다.
